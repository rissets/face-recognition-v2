# Generated by Django 5.2.7 on 2025-10-03 12:40

import django.db.models.deletion
import uuid
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('recognition', '0001_initial'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='DataQualityMetrics',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('date', models.DateField()),
                ('avg_image_quality', models.FloatField()),
                ('avg_face_size', models.FloatField()),
                ('avg_brightness', models.FloatField()),
                ('avg_contrast', models.FloatField()),
                ('avg_sharpness', models.FloatField()),
                ('high_quality_samples', models.PositiveIntegerField(default=0)),
                ('medium_quality_samples', models.PositiveIntegerField(default=0)),
                ('low_quality_samples', models.PositiveIntegerField(default=0)),
                ('blurry_images', models.PositiveIntegerField(default=0)),
                ('over_exposed', models.PositiveIntegerField(default=0)),
                ('under_exposed', models.PositiveIntegerField(default=0)),
                ('obstacles_present', models.PositiveIntegerField(default=0)),
                ('total_samples', models.PositiveIntegerField()),
                ('created_at', models.DateTimeField(auto_now_add=True)),
            ],
            options={
                'verbose_name': 'Data Quality Metrics',
                'verbose_name_plural': 'Data Quality Metrics',
                'ordering': ['-date'],
                'unique_together': {('date',)},
            },
        ),
        migrations.CreateModel(
            name='FaceRecognitionStats',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('date', models.DateField()),
                ('hour', models.PositiveIntegerField(blank=True, null=True)),
                ('total_attempts', models.PositiveIntegerField(default=0)),
                ('successful_attempts', models.PositiveIntegerField(default=0)),
                ('failed_attempts', models.PositiveIntegerField(default=0)),
                ('failed_similarity', models.PositiveIntegerField(default=0)),
                ('failed_liveness', models.PositiveIntegerField(default=0)),
                ('failed_quality', models.PositiveIntegerField(default=0)),
                ('failed_obstacles', models.PositiveIntegerField(default=0)),
                ('failed_no_face', models.PositiveIntegerField(default=0)),
                ('failed_multiple_faces', models.PositiveIntegerField(default=0)),
                ('failed_system_error', models.PositiveIntegerField(default=0)),
                ('avg_response_time', models.FloatField(blank=True, null=True)),
                ('avg_similarity_score', models.FloatField(blank=True, null=True)),
                ('avg_liveness_score', models.FloatField(blank=True, null=True)),
                ('avg_quality_score', models.FloatField(blank=True, null=True)),
                ('unique_users', models.PositiveIntegerField(default=0)),
                ('new_enrollments', models.PositiveIntegerField(default=0)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
            ],
            options={
                'verbose_name': 'Face Recognition Stats',
                'verbose_name_plural': 'Face Recognition Stats',
                'ordering': ['-date', '-hour'],
                'indexes': [models.Index(fields=['date'], name='analytics_f_date_15afd1_idx'), models.Index(fields=['date', 'hour'], name='analytics_f_date_b2790c_idx')],
                'unique_together': {('date', 'hour')},
            },
        ),
        migrations.CreateModel(
            name='SystemMetrics',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('metric_name', models.CharField(max_length=100)),
                ('metric_type', models.CharField(choices=[('counter', 'Counter'), ('gauge', 'Gauge'), ('histogram', 'Histogram'), ('timer', 'Timer')], max_length=20)),
                ('value', models.FloatField()),
                ('unit', models.CharField(blank=True, max_length=20)),
                ('tags', models.JSONField(default=dict)),
                ('timestamp', models.DateTimeField(auto_now_add=True)),
            ],
            options={
                'verbose_name': 'System Metric',
                'verbose_name_plural': 'System Metrics',
                'ordering': ['-timestamp'],
                'indexes': [models.Index(fields=['metric_name', 'timestamp'], name='analytics_s_metric__ba8852_idx'), models.Index(fields=['metric_type', 'timestamp'], name='analytics_s_metric__4088e2_idx')],
            },
        ),
        migrations.CreateModel(
            name='AuthenticationLog',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('attempted_email', models.EmailField(blank=True, max_length=254)),
                ('auth_method', models.CharField(choices=[('face', 'Face Recognition'), ('password', 'Password'), ('2fa', 'Two Factor'), ('social', 'Social Login')], default='face', max_length=20)),
                ('success', models.BooleanField(default=False)),
                ('failure_reason', models.CharField(blank=True, choices=[('invalid_credentials', 'Invalid Credentials'), ('face_not_recognized', 'Face Not Recognized'), ('liveness_failed', 'Liveness Check Failed'), ('quality_too_low', 'Image Quality Too Low'), ('multiple_faces', 'Multiple Faces Detected'), ('no_face_detected', 'No Face Detected'), ('obstacles_detected', 'Obstacles Detected'), ('account_disabled', 'Account Disabled'), ('rate_limited', 'Rate Limited'), ('system_error', 'System Error')], max_length=50)),
                ('ip_address', models.GenericIPAddressField(blank=True, null=True)),
                ('user_agent', models.TextField(blank=True)),
                ('device_fingerprint', models.CharField(blank=True, max_length=255)),
                ('location', models.CharField(blank=True, max_length=100)),
                ('response_time', models.FloatField(blank=True, null=True)),
                ('similarity_score', models.FloatField(blank=True, null=True)),
                ('liveness_score', models.FloatField(blank=True, null=True)),
                ('quality_score', models.FloatField(blank=True, null=True)),
                ('risk_score', models.FloatField(default=0.0, help_text='Calculated risk score for this authentication attempt')),
                ('risk_factors', models.JSONField(default=list, help_text='List of risk factors identified')),
                ('session_id', models.CharField(blank=True, max_length=255)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='auth_logs', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Authentication Log',
                'verbose_name_plural': 'Authentication Logs',
                'ordering': ['-created_at'],
                'indexes': [models.Index(fields=['user', 'created_at'], name='analytics_a_user_id_5adab9_idx'), models.Index(fields=['success', 'created_at'], name='analytics_a_success_9a765b_idx'), models.Index(fields=['auth_method', 'created_at'], name='analytics_a_auth_me_a89fb0_idx'), models.Index(fields=['ip_address', 'created_at'], name='analytics_a_ip_addr_f2e580_idx')],
            },
        ),
        migrations.CreateModel(
            name='ModelPerformance',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('accuracy', models.FloatField()),
                ('precision', models.FloatField()),
                ('recall', models.FloatField()),
                ('f1_score', models.FloatField()),
                ('false_acceptance_rate', models.FloatField(blank=True, null=True)),
                ('false_rejection_rate', models.FloatField(blank=True, null=True)),
                ('test_set_size', models.PositiveIntegerField()),
                ('test_conditions', models.JSONField(default=dict)),
                ('environment', models.CharField(choices=[('development', 'Development'), ('staging', 'Staging'), ('production', 'Production')], max_length=20)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('model', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='performance_metrics', to='recognition.facerecognitionmodel')),
            ],
            options={
                'verbose_name': 'Model Performance',
                'verbose_name_plural': 'Model Performance',
                'ordering': ['-created_at'],
                'indexes': [models.Index(fields=['model', 'created_at'], name='analytics_m_model_i_8c8c97_idx'), models.Index(fields=['environment', 'created_at'], name='analytics_m_environ_314016_idx')],
            },
        ),
        migrations.CreateModel(
            name='SecurityAlert',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('alert_type', models.CharField(choices=[('failed_attempts', 'Multiple Failed Attempts'), ('new_device', 'New Device Login'), ('location_anomaly', 'Unusual Location'), ('time_anomaly', 'Unusual Time'), ('quality_degradation', 'Quality Degradation'), ('system_breach', 'System Breach Attempt'), ('data_anomaly', 'Data Anomaly')], max_length=30)),
                ('severity', models.CharField(choices=[('info', 'Info'), ('low', 'Low'), ('medium', 'Medium'), ('high', 'High'), ('critical', 'Critical')], default='medium', max_length=10)),
                ('ip_address', models.GenericIPAddressField(blank=True, null=True)),
                ('title', models.CharField(max_length=200)),
                ('description', models.TextField()),
                ('context_data', models.JSONField(default=dict)),
                ('acknowledged', models.BooleanField(default=False)),
                ('acknowledged_at', models.DateTimeField(blank=True, null=True)),
                ('resolved', models.BooleanField(default=False)),
                ('resolved_at', models.DateTimeField(blank=True, null=True)),
                ('resolution_notes', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('acknowledged_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='acknowledged_alerts', to=settings.AUTH_USER_MODEL)),
                ('resolved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='resolved_alerts', to=settings.AUTH_USER_MODEL)),
                ('user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='security_alerts', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Security Alert',
                'verbose_name_plural': 'Security Alerts',
                'ordering': ['-created_at'],
                'indexes': [models.Index(fields=['severity', 'created_at'], name='analytics_s_severit_b7cc4e_idx'), models.Index(fields=['user', 'created_at'], name='analytics_s_user_id_247336_idx'), models.Index(fields=['acknowledged', 'resolved'], name='analytics_s_acknowl_ae3511_idx')],
            },
        ),
        migrations.CreateModel(
            name='UserBehaviorAnalytics',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('avg_login_time', models.TimeField(blank=True, null=True)),
                ('common_locations', models.JSONField(default=list)),
                ('device_preferences', models.JSONField(default=dict)),
                ('auth_success_rate', models.FloatField(default=0.0)),
                ('avg_similarity_score', models.FloatField(default=0.0)),
                ('avg_liveness_score', models.FloatField(default=0.0)),
                ('login_frequency', models.FloatField(default=0.0)),
                ('peak_activity_hours', models.JSONField(default=list)),
                ('suspicious_activity_count', models.PositiveIntegerField(default=0)),
                ('last_risk_assessment', models.DateTimeField(blank=True, null=True)),
                ('risk_level', models.CharField(choices=[('low', 'Low'), ('medium', 'Medium'), ('high', 'High'), ('critical', 'Critical')], default='low', max_length=10)),
                ('analysis_start', models.DateTimeField()),
                ('analysis_end', models.DateTimeField()),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='behavior_analytics', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'User Behavior Analytics',
                'verbose_name_plural': 'User Behavior Analytics',
                'unique_together': {('user', 'analysis_start', 'analysis_end')},
            },
        ),
    ]
